<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Hexo | Hexo</title><meta name="author" content="chonqin"><meta name="copyright" content="chonqin"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="​—title:ROS基础date:2025-11-01 21:10description:ROS学习记录​—ROS一、前言使用的ros版本为Noetic版本，基于Ubuntu20.04.6 二、ros是什么 ROS：Robot Operating System 包括了四个part：通信机制、开发工具、应用功能、生态系统 这种模式旨在提高机器人研发中的软件复用率  1.节点(Node) 与 节点">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="https://chonqin.github.io/year/11/01/ROS/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="​—title:ROS基础date:2025-11-01 21:10description:ROS学习记录​—ROS一、前言使用的ros版本为Noetic版本，基于Ubuntu20.04.6 二、ros是什么 ROS：Robot Operating System 包括了四个part：通信机制、开发工具、应用功能、生态系统 这种模式旨在提高机器人研发中的软件复用率  1.节点(Node) 与 节点">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://chonqin.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2025-11-01T13:58:17.823Z">
<meta property="article:modified_time" content="2025-11-01T14:05:50.498Z">
<meta property="article:author" content="chonqin">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://chonqin.github.io/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "",
  "url": "https://chonqin.github.io/year/11/01/ROS/",
  "image": "https://chonqin.github.io/img/butterfly-icon.png",
  "datePublished": "2025-11-01T13:58:17.823Z",
  "dateModified": "2025-11-01T14:05:50.498Z",
  "author": [
    {
      "@type": "Person",
      "name": "chonqin",
      "url": "https://chonqin.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://chonqin.github.io/year/11/01/ROS/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?chonqin";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=chonqin"></script><script>window.dataLayer = window.dataLayer || []
function gtag(){dataLayer.push(arguments)}
gtag('js', new Date())
gtag('config', 'chonqin')
btf.addGlobalFn('pjaxComplete', () => {
  gtag('config', 'chonqin', {'page_path': window.location.pathname})
}, 'google_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Hexo',
  isHighlightShrink: true,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">1</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Hexo</span></a><a class="nav-page-title" href="/"><span class="site-name">Hexo</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">无标题</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-11-01T13:58:17.823Z" title="发表于 2025-11-01 21:58:17">2025-11-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-11-01T14:05:50.498Z" title="更新于 2025-11-01 22:05:50">2025-11-01</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><hr>
<h2 id="​—title-ROS基础date-2025-11-01-21-10description-ROS学习记录​—"><a href="#​—title-ROS基础date-2025-11-01-21-10description-ROS学习记录​—" class="headerlink" title="​—title:ROS基础date:2025-11-01 21:10description:ROS学习记录​—"></a>​—<br>title:ROS基础<br>date:2025-11-01 21:10<br>description:ROS学习记录<br>​—</h2><h1 id="ROS"><a href="#ROS" class="headerlink" title="ROS"></a>ROS</h1><h2 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h2><p>使用的ros版本为Noetic版本，基于Ubuntu20.04.6</p>
<h2 id="二、ros是什么"><a href="#二、ros是什么" class="headerlink" title="二、ros是什么"></a>二、ros是什么</h2><ul>
<li>ROS：Robot Operating System</li>
<li>包括了四个part：通信机制、开发工具、应用功能、生态系统</li>
<li>这种模式旨在提高机器人研发中的软件复用率</li>
</ul>
<h3 id="1-节点-Node-与-节点管理器-Node-Master"><a href="#1-节点-Node-与-节点管理器-Node-Master" class="headerlink" title="1.节点(Node) 与 节点管理器(Node Master)"></a>1.节点(Node) 与 节点管理器(Node Master)</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/e4cf4abf66181a4b6c4d6ccd5ff8c5e9.png#pic_center" alt="img"></p>
<h3 id="2-通信模式之一——Topic模式"><a href="#2-通信模式之一——Topic模式" class="headerlink" title="2.通信模式之一——Topic模式"></a>2.通信模式之一——Topic模式</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/6b5151a88a7d50ae4b4ac6e995fbe274.png#pic_center" alt="img"></p>
<ul>
<li>Message：定义数据的类型，具有一定的数据结构定义</li>
<li>单向的，可多次</li>
<li>数据的管道称为Topic（话题）</li>
<li>使用 发布&amp;订阅 模型，右下图显示了Camera Node是发布者，图像处理节点和图像显示节点是订阅者。</li>
<li>话题的消息的接口使用 .msg 文件定义</li>
</ul>
<h3 id="3通信模式之二——Service模式"><a href="#3通信模式之二——Service模式" class="headerlink" title="3通信模式之二——Service模式"></a>3通信模式之二——Service模式</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/5526214ed935d789e03d828b463f0ad4.png#pic_center" alt="在这里插入图片描述"></p>
<ul>
<li>C&#x2F;S模型</li>
<li>带有反馈的机制</li>
<li>双向的，来往一次</li>
<li>如左下图，图像处理节点向Camera节点发出请求（比如上调图像分辨率），Camera节点上调分辨率后向图像处理节点发出反馈。</li>
<li>服务的数据内容可用 .srv 自定义</li>
</ul>
<h3 id="4-两者对比"><a href="#4-两者对比" class="headerlink" title="4.两者对比"></a>4.两者对比</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/5797a3624420670cdd2c0962a3a6efcb.png#pic_center" alt="img"></p>
<h3 id="参数-Parameter"><a href="#参数-Parameter" class="headerlink" title="参数(Parameter)"></a>参数(Parameter)</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/a43896255ea289882e9ec61987f5cf2f.png#pic_center" alt="在这里插入图片描述"></p>
<ul>
<li>参数是一个“字典”</li>
<li>存储在ROS Master服务器，节点可以对参数存储、检索、更新（如图）</li>
<li>适合静态存储、非二进制</li>
</ul>
<h2 id="三、文件系统"><a href="#三、文件系统" class="headerlink" title="三、文件系统"></a>三、文件系统</h2><p><img src="https://i-blog.csdnimg.cn/blog_migrate/f92abef3679ce9fee72cd879d885ff98.png#pic_center" alt="在这里插入图片描述"></p>
<ul>
<li>文件系统代表了代码的结构</li>
</ul>
<h2 id="四、ROS命令行工具"><a href="#四、ROS命令行工具" class="headerlink" title="四、ROS命令行工具"></a>四、ROS命令行工具</h2><h3 id="1-回顾第一个小海龟程序"><a href="#1-回顾第一个小海龟程序" class="headerlink" title="1.回顾第一个小海龟程序"></a>1.回顾第一个小海龟程序</h3><p>打开小海龟程序：<br> 终端，启动ROS Master：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roscore</span><br></pre></td></tr></table></figure>

<p>终端2，启动小海龟仿真器：<br> （输入<code>rosrun turtlesim</code>，敲两下<code>Tab</code>健可查看该命令下有哪些功能）</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun turtlesim turtlesim_node</span><br></pre></td></tr></table></figure>

<p>终端3，启动海龟控制节点：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun turtlesim turtle_teleop_key</span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/blog_migrate/697323cffea407d3f72f3cdaee58a02a.png#pic_center" alt="在这里插入图片描述"></p>
<h3 id="2-查看系统中的计算图：rqt-graph"><a href="#2-查看系统中的计算图：rqt-graph" class="headerlink" title="2.查看系统中的计算图：rqt_graph"></a>2.查看系统中的计算图：rqt_graph</h3><p>新建终端窗口：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rqt_graph</span><br></pre></td></tr></table></figure>

<p>可展示系统中运行的计算图：<br> <img src="https://i-blog.csdnimg.cn/blog_migrate/99b2537f738a69cc0a22ab5e3a82acbc.png#pic_center" alt="在这里插入图片描述">可以清晰地了解系统节点间通信的部分信息。<br> teleop_turtle节点（键盘控制节点）通过cmd_vel（<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=topic&spm=1001.2101.3001.7020">topic</a>）向turtlesim节点（海归仿真器节点）发出消息，使得小海龟移动。</p>
<h3 id="3-rosnode"><a href="#3-rosnode" class="headerlink" title="3.rosnode"></a>3.rosnode</h3><h4 id="显示节点列表：rosnode-list"><a href="#显示节点列表：rosnode-list" class="headerlink" title="显示节点列表：rosnode list"></a>显示节点列表：rosnode list</h4><p><img src="https://i-blog.csdnimg.cn/blog_migrate/925ad456811072eabab0b16e704def72.png#pic_center" alt="在这里插入图片描述">可以看到有3个节点。</p>
<h4 id="查看节点信息：rosnode-info"><a href="#查看节点信息：rosnode-info" class="headerlink" title="查看节点信息：rosnode info"></a>查看节点信息：rosnode info</h4><p>查看节点的具体信息：<code>rosnode info /节点名</code><br> 我们查看海龟仿真器节点&#x2F;turtlesim的信息：<br> <img src="https://i-blog.csdnimg.cn/blog_migrate/6f3eb2ad18e3173f7adc066991ce6d41.png#pic_center" alt="在这里插入图片描述"><br> 可以看到海龟仿真器节点&#x2F;turtlesim自己有一些发布和订阅，也有一些服务。</p>
<h3 id="4-rostopic"><a href="#4-rostopic" class="headerlink" title="4.rostopic"></a>4.rostopic</h3><h4 id="显示topic列表：rostopic-list"><a href="#显示topic列表：rostopic-list" class="headerlink" title="显示topic列表：rostopic list"></a>显示topic列表：rostopic list</h4><p><img src="https://i-blog.csdnimg.cn/blog_migrate/ab34938183af1424055c4a3c20159ea7.png#pic_center" alt="在这里插入图片描述"></p>
<h4 id="手动发布数据给topic"><a href="#手动发布数据给topic" class="headerlink" title="手动发布数据给topic"></a>手动发布数据给topic</h4><p>我们来手动发布数据给topic来控制海龟移动，使用<code>rostopic pub</code><br> 上图我们看到小海龟是通过&#x2F;cmd_vel这个topic进行发布信息而移动的，这次我们通过手动publish数据给这个topic来控制小海龟移动。<br> 格式：<code>rostopic pub (参数) 话题名 消息数据结构 “具体数据”</code><br> 例，我们输入：（我们可以使用Tab键让我们自动填充数据，使用方向键←→移动到指定位置修改数据，比如我们把x的0.0改成了1.0）</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">rostopic pub /turtle1/cmd_vel geometry_msgs/Twist <span class="string">&quot;linear:</span></span><br><span class="line"><span class="string">  x: 1.0</span></span><br><span class="line"><span class="string">  y: 0.0</span></span><br><span class="line"><span class="string">  z: 0.0</span></span><br><span class="line"><span class="string">angular:</span></span><br><span class="line"><span class="string">  x: 0.0</span></span><br><span class="line"><span class="string">  y: 0.0</span></span><br><span class="line"><span class="string">  z: 0.0&quot;</span></span><br></pre></td></tr></table></figure>

<p>小海龟沿着正前方向移动了1单位，我们再使用参数<code>-r 5</code>移动5次，小海龟就撞上了南墙。<br> Ctrl+C就可以终止。<br> <img src="https://i-blog.csdnimg.cn/blog_migrate/000001a66bd5d198841ecc3c559f628b.png#pic_center" alt="在这里插入图片描述"></p>
<h3 id="5-rosmsg"><a href="#5-rosmsg" class="headerlink" title="5.rosmsg"></a>5.rosmsg</h3><h4 id="查看消息数据结构"><a href="#查看消息数据结构" class="headerlink" title="查看消息数据结构"></a>查看消息数据结构</h4><p>上例我们使用了<strong>消息数据结构</strong>定义了一个消息传给topic，我们可以查看有哪些消息数据结构。<br> 查看消息数据结构使用：rosmsg show …<br> 在输入过程中，我们可以勤使用Tab键查看或填充内容。<br> <img src="https://i-blog.csdnimg.cn/blog_migrate/a446daca224d4bc77e761ef2692c3a45.png#pic_center" alt="在这里插入图片描述">我们可以看到geometry_msgs&#x2F;Twist数据结构的内容。</p>
<h3 id="6-使用服务通信方式：rosservice"><a href="#6-使用服务通信方式：rosservice" class="headerlink" title="6.使用服务通信方式：rosservice"></a>6.使用服务<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F&spm=1001.2101.3001.7020">通信方式</a>：rosservice</h3><p>上例我们使用了向topic传msg来控制节点，这次我们试试第二种通信方式service。</p>
<h4 id="查看服务列表：rosservice-list"><a href="#查看服务列表：rosservice-list" class="headerlink" title="查看服务列表：rosservice list"></a>查看服务列表：rosservice list</h4><p><img src="https://i-blog.csdnimg.cn/blog_migrate/32719771b899013c1c6ac95849ddcdb5.png#pic_center" alt="在这里插入图片描述"></p>
<h4 id="手动通过服务来进行操作"><a href="#手动通过服务来进行操作" class="headerlink" title="手动通过服务来进行操作"></a>手动通过服务来进行操作</h4><p>这次我们通过人工产生服务（service）来诞生一只新海龟，使用rosservice call &#x2F;spawn …<br> 在服务列表中，有个&#x2F;spawn服务，可以产生一只新的海龟。<br> 格式：<code>rosservice call (参数) 服务名 “具体数据”</code><br> <img src="https://i-blog.csdnimg.cn/blog_migrate/db80ee57a72b73228a2a1050d5cb6ed9.png#pic_center" alt="在这里插入图片描述"><br> 这时我们再输入<code>rostopic list</code>，可以看到turtle2已经在topic里了。</p>
<h3 id="7-话题记录和复现：rosbag"><a href="#7-话题记录和复现：rosbag" class="headerlink" title="7.话题记录和复现：rosbag"></a>7.话题记录和复现：rosbag</h3><p>试想我们尝试让海龟以我们指定的路径移动了一回，我们想要把它 记录下来，拷贝到自己的实验室再复现出来，我们就可以使用话题记录功能。<br> 常用命令：<code>rosbag record -a -O 文件名</code><br> 比如我们使用之前打开的键盘操作器让海龟移动一圈并记录下来：<br> （1）打开新终端输入<code>rosbag record -a -O cmd_record</code><br> 这样就开始记录了：<br> <img src="https://i-blog.csdnimg.cn/blog_migrate/8c34c3e8ba55b97fef872094a0e9967e.png#pic_center" alt="在这里插入图片描述">（2）移动一下：<br> <img src="https://i-blog.csdnimg.cn/blog_migrate/d4a97523dd1e02ba3d9f3de572cc0ddd.png#pic_center" alt="在这里插入图片描述">到记录界面按Ctrl+C停止：<br> <img src="https://i-blog.csdnimg.cn/blog_migrate/ab9d48b8d0bb0f1958b197bcc8102c3f.png#pic_center" alt="在这里插入图片描述">文件就记录在了这里：<img src="https://i-blog.csdnimg.cn/blog_migrate/02513d9713deb389df68bf2e412308d9.png#pic_center" alt="在这里插入图片描述"><br> （3）接下去关闭所有打开的ros节点<br> 重新开启roscore，开启海龟节点rosrun turtlesim turtlesim_node<br> 这时我们输入 <code>rosbag play cmd_record</code>就可以复现之前的移动啦！<br> <img src="https://i-blog.csdnimg.cn/blog_migrate/f2b14c6c527a5afe88585f93ceed7931.png#pic_center" alt="在这里插入图片描述"></p>
<h2 id="五、创建ros工作空间与功能包"><a href="#五、创建ros工作空间与功能包" class="headerlink" title="五、创建ros工作空间与功能包"></a>五、创建ros工作空间与功能包</h2><h3 id="1-What-is-Workspace-工作空间"><a href="#1-What-is-Workspace-工作空间" class="headerlink" title="1.What is Workspace(工作空间)"></a>1.What is Workspace(工作空间)</h3><p>工作空间（Workspace）：存放工程开发相关文件的文件夹。类似一个IDE（例如Pycharm）新建一个工程，就是一个工作空间。包含4个文件夹：</p>
<ul>
<li>src：代码空间（Source Space）：放置功能包代码</li>
<li>build：编译空间（Build Space）：编译过程中产生的中间文件，不用过多关注</li>
<li>devel：开发空间（Development Space）：放置编译生成的可执行文件、库、脚本</li>
<li>install：安装空间（Install Space）：存放可执行文件，与上面有一定重复</li>
</ul>
<h3 id="2-创建工作空间"><a href="#2-创建工作空间" class="headerlink" title="2 .创建工作空间"></a>2 .创建工作空间</h3><h4 id="创建"><a href="#创建" class="headerlink" title="创建:"></a>创建:</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p ~/catkin_ws/src</span><br><span class="line">cd ~/catkin_ws/src 		//进入路径</span><br><span class="line">catkin_init_workspace	//创建</span><br></pre></td></tr></table></figure>

<p>我们先创建一个src文件夹，然后进入该文件夹<br>第3行catkin_init_workspace意为将当前文件夹变为工作空间，使其拥有工作空间的属性</p>
<p>注：“~&#x2F;”意为当前用户名目录；“-p”意为递归创建目录，即直接创建多级目录。<br>src文件夹即代码空间，<strong>不能自行用别的名称代替</strong></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/295b716b8c61ab30db59a08f20365092.png#pic_center" alt="img">可以看到创建了这么一个txt文件，说明创建工作空间成功。</p>
<h4 id="编译空代码的工作空间"><a href="#编译空代码的工作空间" class="headerlink" title="编译空代码的工作空间"></a>编译空代码的工作空间</h4><p>要编译工作空间，先要回到工作空间的根目录。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/catkin_ws //</span><br><span class="line">catkin_make</span><br></pre></td></tr></table></figure>

<p>使用catkin_make为编译指令，将src里的源码进行编译</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/200bc54200a700eaebfd9d1884fc8b08.png#pic_center" alt="img"></p>
<p>可以看到生成了build和devel两个新文件夹，devel存放了编译完成的内容。<br> 这里没有生成install文件夹，要生成install文件夹，输入<code>catkin_make install</code>：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/a0d7c51839653be7056a87d3248cea71.png#pic_center" alt="在这里插入图片描述"></p>
<p>install中生成了可执行文件。</p>
<p>这样一个空的工作空间创建好了，并且空的代码空间（功能包）编译完成。</p>
<h3 id="3-创建功能包"><a href="#3-创建功能包" class="headerlink" title="3.创建功能包"></a>3.创建功能包</h3><p><strong>功能包</strong>是放置ROS源码的最小单元。</p>
<p>上面我们创建了一个空的工作空间，src文件夹里面没写东西，现在我们创建一个自己的功能包。</p>
<p><strong>注意同一工作空间下，不允许存在同名功能包；不同工作空间下，允许存在同名功能包</strong>。</p>
<p>指令格式：<strong>catkin_create_pkg <package_name> [depend1] [depend2] [depend3]</strong></p>
<p><package_name>为包名</p>
<p>[depend]为依赖，即指明编译的时候需要ROS中的其他功能包，如需要调用python、C++库，就要指明rospy、roscpp</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/catkin_ws/src</span><br><span class="line">catkin_create_pkg test_pkg std_msgs rospy roscpp</span><br></pre></td></tr></table></figure>

<p>创建后记得编译一下。</p>
<h3 id="4-设置并检查环境变量"><a href="#4-设置并检查环境变量" class="headerlink" title="4.设置并检查环境变量"></a>4.设置并检查环境变量</h3><p>编译完功能包后，为了运行，先<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E8%AE%BE%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F&spm=1001.2101.3001.7020">设置环境变量</a>，以便系统找到我们的工作空间和功能包。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/catkin_ws/devel/setup.bash</span><br></pre></td></tr></table></figure>

<p>检查：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$ROS_PACKAGE_PATH</span></span><br></pre></td></tr></table></figure>

<h2 id="六、发布者Publisher的编程实现"><a href="#六、发布者Publisher的编程实现" class="headerlink" title="六、发布者Publisher的编程实现"></a>六、发布者Publisher的编程实现</h2><p>编程publisher 发送 message 产生topic，让海龟（sub）订阅实现功能。</p>
<p>进入src，创建功能包。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">catkin_create_pkg learning_topic roscpp rospy std_msgs geometry_msgs turtlesim</span><br></pre></td></tr></table></figure>

<h3 id="如何实现一个发布者程序："><a href="#如何实现一个发布者程序：" class="headerlink" title="如何实现一个发布者程序："></a>如何实现一个发布者程序：</h3><ul>
<li>初始化ROS节点</li>
<li>向ROS Master 注册节点信息，包括话题名和话题数据类型</li>
<li>创建消息数据</li>
<li>按照一定频率循环发布消息</li>
</ul>
<h3 id="具体操作如下："><a href="#具体操作如下：" class="headerlink" title="具体操作如下："></a>具体操作如下：</h3><ul>
<li><p>先在src目录下创建源文件（c++&#x2F;Python）</p>
</li>
<li><p>编写程序，修改cmakelist文件，回到工作空间编译并source</p>
</li>
<li><p>终端运行roscore，再打开一个终端运行rosrun +功能包下的程序</p>
</li>
<li><p>最终能看到小海龟按设定的程序运动</p>
</li>
</ul>
<h3 id="具体程序如下："><a href="#具体程序如下：" class="headerlink" title="具体程序如下："></a>具体程序如下：</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ros/ros.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;geometry_msgs/Twist.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// ROS节点初始化</span></span><br><span class="line">	ros::<span class="built_in">init</span>(argc, argv, <span class="string">&quot;velocity_publisher&quot;</span>);</span><br><span class="line">	<span class="comment">// 创建节点句柄</span></span><br><span class="line">	ros::NodeHandle n;</span><br><span class="line">	<span class="comment">// 创建一个Publisher，发布名为/turtle1/cmd_vel的topic，消息类型为geometry_msgs::Twist，队列长度10</span></span><br><span class="line">	ros::Publisher turtle_vel_pub = n.<span class="built_in">advertise</span>&lt;geometry_msgs::Twist&gt;(<span class="string">&quot;/turtle1/cmd_vel&quot;</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 设置循环的频率</span></span><br><span class="line">	<span class="function">ros::Rate <span class="title">loop_rate</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (ros::<span class="built_in">ok</span>())</span><br><span class="line">	&#123;</span><br><span class="line">	    <span class="comment">// 初始化geometry_msgs::Twist类型的消息</span></span><br><span class="line">		geometry_msgs::Twist vel_msg;</span><br><span class="line">		vel_msg.linear.x = <span class="number">0.5</span>;</span><br><span class="line">		vel_msg.angular.z = <span class="number">0.2</span>;</span><br><span class="line">	    <span class="comment">// 发布消息</span></span><br><span class="line">		turtle_vel_pub.<span class="built_in">publish</span>(vel_msg);</span><br><span class="line">		<span class="built_in">ROS_INFO</span>(<span class="string">&quot;Publsh turtle velocity command[%0.2f m/s, %0.2f rad/s]&quot;</span>, vel_msg.linear.x, vel_msg.angular.z);</span><br><span class="line">	    <span class="comment">// 按照循环频率延时</span></span><br><span class="line">	    loop_rate.<span class="built_in">sleep</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="七、订阅者Sub的实现"><a href="#七、订阅者Sub的实现" class="headerlink" title="七、订阅者Sub的实现"></a>七、订阅者Sub的实现</h2><ul>
<li>初始化ROS节点</li>
<li>订阅需要的话题</li>
<li>循环等待话题消息，接收到消息后进入回调函数</li>
<li>在回调函数中完成消息处理</li>
</ul>
<p>操作和上面pub一样</p>
<h3 id="程序如下"><a href="#程序如下" class="headerlink" title="程序如下"></a>程序如下</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;geometry_msgs/Twist.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ros/init.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ros/node_handle.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ros/subscriber.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;turtlesim/Pose.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">poseCallback</span><span class="params">(<span class="type">const</span> turtlesim::Pose::ConstPtr&amp; msg)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">&quot;turtle pose : x :%0.6f, y :%0.6f&quot;</span>,msg-&gt;x,msg-&gt;y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ros初始化</span></span><br><span class="line">    ros::<span class="built_in">init</span>(argc, argv, <span class="string">&quot;pose_subscriber&quot;</span>);</span><br><span class="line">    <span class="comment">//创建节点的句柄</span></span><br><span class="line">    ros::NodeHandle n ;</span><br><span class="line">    <span class="comment">//创建一个Subscriber，订阅名为/turtle/pose,注册回调函数poseCallback</span></span><br><span class="line">    ros::Subscriber pose_sub = n.<span class="built_in">subscribe</span>(<span class="string">&quot;/turtle1/pose&quot;</span>, <span class="number">10</span> , poseCallback) ;</span><br><span class="line">    <span class="comment">//循环等待回调函数</span></span><br><span class="line">    ros::<span class="built_in">spin</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此程序可以读取小海龟的位置</p>
<p>将pub和sub结合起来后的效果就是，海龟沿着设定的运动，然后sub获取他的位置</p>
<p>使用rqt-graph进行查看</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250919211003647.png" alt="image-20250919211003647"></p>
<h2 id="八、话题消息的定义和使用"><a href="#八、话题消息的定义和使用" class="headerlink" title="八、话题消息的定义和使用"></a>八、话题消息的定义和使用</h2><ul>
<li><p>Message 是一种自定义的数据结构，用于话题间的数据存储和传输</p>
</li>
<li><p>之前两节使用了Topic模型，我们先使用了Twist类型（geometry_msgs.msg库下的Twist类）的Message作为输入指令进行发布，接着使用了Pose类型（Turtlesim.msg库下的Pose类）的Message作为订阅消息进行接收。</p>
<p>  使用rosmsg show命令查看</p>
<p>  <img src="/home/chonqin/.config/Typora/typora-user-images/image-20250920110325714.png" alt="image-20250920110325714"></p>
<p>  以上的<strong>Message</strong>消息都是预定义好的，当我们需要自定义消息该怎么做呢？</p>
</li>
</ul>
<p>如何操作：</p>
<ul>
<li><p>创建msg文件</p>
<p>  进入功能包目录里，新建msg文件夹，将所有自定义msg文件放入里面</p>
<p>  使用touch命令新建一个msg文件，将定义的东西放入msg中</p>
  <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch Person.msg//P要大写</span><br></pre></td></tr></table></figure>

<p>  <img src="/home/chonqin/.config/Typora/typora-user-images/image-20250920105335067.png" alt="image-20250920105335067"></p>
</li>
<li><p>在package.xml添加功能包依赖</p>
<p>  将以下两行粘贴进入文件内</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;build_depend&gt;message_generation&lt;/build_depend&gt;</span><br><span class="line">&lt;exec_depend&gt;message_runtime&lt;/exec_depend&gt;</span><br></pre></td></tr></table></figure>



<ul>
<li><p>在cmakelist中也要更改编译选项，把自定义msg文件添加到编译环境中</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">find_package( ...... message_generation)</span><br><span class="line"></span><br><span class="line">add_message_files(FILES Person.msg)</span><br><span class="line">generate_messages(DEPENDENCIES std_msgs)</span><br><span class="line"></span><br><span class="line">catkin_package( ...... message_runtime)</span><br></pre></td></tr></table></figure>

<p>  说明如下：</p>
<ul>
<li><p>因为在package.xml添加了功能包编译依赖，在CMakeList.txt里的find_package中也要加上对应的部分；</p>
</li>
<li><p>需要将定义的Person.msg作为消息接口，针对它做编译；<br>  需要指明编译这个消息接口需要哪些ROS已有的包；</p>
</li>
<li><p>有了34这两个配置才可将定义的msg编译成不同的程序文件</p>
</li>
<li><p>因为在package.xml添加了功能包执行依赖，在CMakeList.txt里的catkin_package中也要加上对应的部分</p>
</li>
</ul>
</li>
<li><p>最后回到工作空间进行编译</p>
</li>
</ul>
<h2 id="九、Servce模式的编程与使用"><a href="#九、Servce模式的编程与使用" class="headerlink" title="九、Servce模式的编程与使用"></a>九、Servce模式的编程与使用</h2><p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250920173350676.png" alt="image-20250920173350676"></p>
<p>Sever端是海龟仿真器节点，Client端是等待实现的节点，产生Request的请求，发送给Sever端。Sever端接受请求后产生一只海龟，并返回Response。中间传输的数据结构为定义好的turtlesim：：Spawn。</p>
<ul>
<li><p>老样子，创建一个learing_servce的pkg，添加必要的依赖</p>
</li>
<li><p>新建一个c++文件，放入src目录下</p>
</li>
<li><p>更改cmakelist文件的编译选项，编译文件</p>
</li>
<li><p>开启roscore，进行rosrun，实现功能</p>
<h3 id="程序如下-1"><a href="#程序如下-1" class="headerlink" title="程序如下"></a>程序如下</h3>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 初始化ROS节点</span></span><br><span class="line">	ros::<span class="built_in">init</span>(argc, argv, <span class="string">&quot;turtle_spawn&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建节点句柄</span></span><br><span class="line">	ros::NodeHandle node;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 发现/spawn服务后，创建一个服务客户端，连接名为/spawn的service</span></span><br><span class="line">	ros::service::<span class="built_in">waitForService</span>(<span class="string">&quot;/spawn&quot;</span>);</span><br><span class="line">	ros::ServiceClient add_turtle = node.<span class="built_in">serviceClient</span>&lt;turtlesim::Spawn&gt;(<span class="string">&quot;/spawn&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化turtlesim::Spawn的请求数据</span></span><br><span class="line">	turtlesim::Spawn srv;</span><br><span class="line">	srv.request.x = <span class="number">2.0</span>;</span><br><span class="line">	srv.request.y = <span class="number">2.0</span>;</span><br><span class="line">	srv.request.name = <span class="string">&quot;turtle2&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 请求服务调用</span></span><br><span class="line">	<span class="built_in">ROS_INFO</span>(<span class="string">&quot;Call service to spwan turtle[x:%0.6f, y:%0.6f, name:%s]&quot;</span>, </span><br><span class="line">			 srv.request.x, srv.request.y, srv.request.name.<span class="built_in">c_str</span>());</span><br><span class="line"></span><br><span class="line">	add_turtle.<span class="built_in">call</span>(srv);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 显示服务调用结果</span></span><br><span class="line">	<span class="built_in">ROS_INFO</span>(<span class="string">&quot;Spwan turtle successfully [name:%s]&quot;</span>, srv.response.name.<span class="built_in">c_str</span>());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>  <img src="/home/chonqin/.config/Typora/typora-user-images/image-20250920165919601.png" alt="image-20250920165919601"></p>
</li>
</ul>
<p>启动turle_spawn后，可以看到先是等待service应答</p>
<p>随后开启turtlrsim节点后，服务应答，就在对应位置添加了一个新的小海龟</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250920170115886.png" alt="image-20250920170115886"></p>
<h2 id="十、服务端Sever的编程实现"><a href="#十、服务端Sever的编程实现" class="headerlink" title="十、服务端Sever的编程实现"></a>十、服务端Sever的编程实现</h2><p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250920174015847.png" alt="image-20250920174015847"></p>
<p>Server端本身是进行模拟海龟运动的命令端，它的实现是通过给海龟发送速度（Twist）的指令，来控制海龟运动（本身通过Topic实现）。</p>
<p>Client端相当于海龟运动的开关，其发布Request来控制Server端。<br>通过自定义名为 &#x2F;turtle_command 的Service实现，中间传输消息的数据类型为std_srvs::Trigger（一种针对服务标准std_srvs下的数据定义）来通信。Trigger意为触发，通过Trigger信号来触发Server端的运动指令。<br>Server端接收这个Trigger信号后，可控制其是否要给海龟发送Twist指令，同时给Client发送Response反馈告诉它海龟的运动状态</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b71bbe429ce84281c88ef0c910dd78f8.png#pic_center" alt="img"></p>
<p>开启rosmaster，turtlesim之后</p>
<p> 接着我们使用<code>rosservice call ...</code>请求海龟动起来，再打开一个终端。<br> （输入完 &#x2F;turtle_command 后敲个空格再用Tab键可自动填充空指令内容）</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosservice call /turtle_command <span class="string">&quot;&#123;&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<p>就可以看到海龟动起来了</p>
<h2 id="十一、服务数据srv的使用"><a href="#十一、服务数据srv的使用" class="headerlink" title="十一、服务数据srv的使用"></a>十一、服务数据srv的使用</h2><p>在第8节我们讲解了话题消息msg的定义与使用，在第8节的例子中我们曾自定义了一个消息类型“Person”以发布个人信息，Publisher发布个人信息，Subscriber接收个人信息。</p>
<p>这个例子中，Publisher会不断地发信息，Subscriber不停地接数据，一开动就停不下来了，也是topic模式的缺陷。</p>
<p>本节我们使用Service模式用自定义的服务数据srv来实现，我们希望Request一次才发一次信息来显示。</p>
<h3 id="创建srv文件"><a href="#创建srv文件" class="headerlink" title="创建srv文件"></a>创建srv文件</h3><p>在pkg功能包目录下创建srv文件夹，并使用touch命令生成.srv文件</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250922190659468.png" alt="image-20250922190659468"></p>
<p>在文件中写入数据结构的内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">string name</span><br><span class="line">uint8 sex</span><br><span class="line">uint8 age</span><br><span class="line"></span><br><span class="line">uint8 unknown = 0</span><br><span class="line">uint8 male = 1</span><br><span class="line">uint8 female = 2</span><br><span class="line">---</span><br><span class="line">string result</span><br><span class="line">//与之前Person.msg不同的是，多了破折号下面这个Response结果，上面的是Request内容。</span><br><span class="line">//定义好srv数据接口后，就可以根据这个定义用C++或Python编译</span><br></pre></td></tr></table></figure>

<h3 id="添加功能包依赖"><a href="#添加功能包依赖" class="headerlink" title="添加功能包依赖"></a>添加功能包依赖</h3><p>由于此srv是自定义的，最初创建的时候没有添加依赖，所以要手动修改package.xml文件添加依赖。找到文件，把下面复制进去就好了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;build_depend&gt;message_generation&lt;/build_depend&gt;</span><br><span class="line">//添加编译依赖</span><br><span class="line">&lt;exec_depend&gt;message_runtime&lt;/exec_depend&gt;</span><br><span class="line">//添加执行依赖</span><br></pre></td></tr></table></figure>

<h3 id="添加编译选项"><a href="#添加编译选项" class="headerlink" title="添加编译选项"></a>添加编译选项</h3><p>打开CMakeLists.txt，添加编译选项，才能顺利的把srv文件编译出来。</p>
<p>大致上为四条，找到对应的部分进行更改即可。</p>
<p>每一部分都有注释在上方进行介绍。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">find_package( ...... message_generation)</span><br><span class="line"></span><br><span class="line">add_service_files(FILES Person.srv)</span><br><span class="line">generate_messages(DEPENDENCIES std_msgs)</span><br><span class="line"></span><br><span class="line">catkin_package( ...... message_runtime)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>还得把自己写的cpp文件添加进去编译</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">add_executable(person_server src/person_server.cpp)</span><br><span class="line">target_link_libraries(person_server $&#123;catkin_LIBRARIES&#125;)</span><br><span class="line">add_dependencies(person_server $&#123;PROJECT_NAME&#125;_gencpp)</span><br><span class="line"></span><br><span class="line">add_executable(person_client src/person_client.cpp)</span><br><span class="line">target_link_libraries(person_client $&#123;catkin_LIBRARIES&#125;)</span><br><span class="line">add_dependencies(person_client $&#123;PROJECT_NAME&#125;_gencpp)</span><br></pre></td></tr></table></figure>

<p>第三项是添加依赖项，因为代码涉及到动态生成，我们需要将可执行文件与动态生成的程序产生依赖关系。<br><strong>注：这里添加的依赖项用到的是gencpp包，是一个C++用的ROS message 和 service 生成器，以依赖动态生成的cpp文件</strong>。</p>
<h3 id="最后，编译并运行"><a href="#最后，编译并运行" class="headerlink" title="最后，编译并运行"></a>最后，编译并运行</h3><p>运行rosmaster，及其功能包，不再重复。</p>
<p>可以看到运行Server后，启动Client会发一次人物信息，在Server端看到，看到后反馈给Client确认后终止这次发送行为。<br>先运行Client的话则会一直等待Server端接收，直到Server端启动接收到信息</p>
<h2 id="十二、参数的使用与编程"><a href="#十二、参数的使用与编程" class="headerlink" title="十二、参数的使用与编程"></a>十二、参数的使用与编程</h2><ul>
<li><p>至此我们学习了ROS中的两种核心通信机制：Topic（话题）模式 和 Service（服务）模式。</p>
</li>
<li><p>Topic中的Publisher、Subscriber，Service中的Client、Server，消息类型msg、srv以及它们的自定义数据类型。 </p>
</li>
<li><p>这次讲讲参数的使用</p>
</li>
</ul>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>在ROS Master中，存在一个参数服务器（Parameter Server），它是一个全局字典，即一个全局变量的存储空间，用来保存各个节点的配置参数。各个节点都可以对参数进行全局访问。</p>
<h3 id="创建pkg"><a href="#创建pkg" class="headerlink" title="创建pkg"></a>创建pkg</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~/Ros_WorkSpace/src</span><br><span class="line">catkin_create_pkg learning_parameter roscpp rospy std_srvs</span><br></pre></td></tr></table></figure>

<h3 id="rosparam使用"><a href="#rosparam使用" class="headerlink" title="rosparam使用"></a>rosparam使用</h3><p>在ROS中，参数文件常以YAML文件的格式保存</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250922194609158.png" alt="image-20250922194609158"></p>
<p>打开海龟节点后使用list命令看一下：</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250922194738800.png" alt="image-20250922194738800"></p>
<p>可以使用get命令获取某个参数值</p>
<p>eg：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosparam get /turtlesim/background_b </span><br></pre></td></tr></table></figure>

<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250922194923502.png" alt="image-20250922194923502"></p>
<p>也可以更改这些参数，使用set命令，随后使用get查看到已经更改。</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250922195108210.png" alt="image-20250922195108210"></p>
<p>但是，实际海龟背景尚未改变，发送一个clear的空内容服务请求。</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250922195238238.png" alt="image-20250922195238238"></p>
<p>这样子命令行更改有点麻烦，可以导出参数文件，更改后再load回去。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rosparam dump param.yaml</span><br><span class="line">//导出参数，并保存为param.yaml文件</span><br></pre></td></tr></table></figure>

<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250922195757467.png" alt="image-20250922195757467"></p>
<p>打开后，更改参数然后保存。</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250922195829768.png" alt="image-20250922195829768"></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosparam load param.yaml</span><br></pre></td></tr></table></figure>

<p>随后，导入参数，再clear一下，可以看到颜色更改了。</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250922200000961.png" alt="image-20250922200000961"></p>
<p>其他的命令自己可以尝试。</p>
<h3 id="利用程序来使用参数"><a href="#利用程序来使用参数" class="headerlink" title="利用程序来使用参数"></a>利用程序来使用参数</h3><p>程序如下</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> red, green, blue;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ROS节点初始化</span></span><br><span class="line">    ros::<span class="built_in">init</span>(argc, argv, <span class="string">&quot;parameter_config&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建节点句柄</span></span><br><span class="line">    ros::NodeHandle node;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取背景颜色参数</span></span><br><span class="line">	ros::param::<span class="built_in">get</span>(<span class="string">&quot;/turtlesim/background_r&quot;</span>, red);</span><br><span class="line">	ros::param::<span class="built_in">get</span>(<span class="string">&quot;/turtlesim/background_g&quot;</span>, green);</span><br><span class="line">	ros::param::<span class="built_in">get</span>(<span class="string">&quot;/turtlesim/background_b&quot;</span>, blue);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">ROS_INFO</span>(<span class="string">&quot;Get Backgroud Color[%d, %d, %d]&quot;</span>, red, green, blue);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 设置背景颜色参数</span></span><br><span class="line">	ros::param::<span class="built_in">set</span>(<span class="string">&quot;/turtlesim/background_r&quot;</span>, <span class="number">255</span>);</span><br><span class="line">	ros::param::<span class="built_in">set</span>(<span class="string">&quot;/turtlesim/background_g&quot;</span>, <span class="number">255</span>);</span><br><span class="line">	ros::param::<span class="built_in">set</span>(<span class="string">&quot;/turtlesim/background_b&quot;</span>, <span class="number">255</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">ROS_INFO</span>(<span class="string">&quot;Set Backgroud Color[255, 255, 255]&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取背景颜色参数</span></span><br><span class="line">	ros::param::<span class="built_in">get</span>(<span class="string">&quot;/turtlesim/background_r&quot;</span>, red);</span><br><span class="line">	ros::param::<span class="built_in">get</span>(<span class="string">&quot;/turtlesim/background_g&quot;</span>, green);</span><br><span class="line">	ros::param::<span class="built_in">get</span>(<span class="string">&quot;/turtlesim/background_b&quot;</span>, blue);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">ROS_INFO</span>(<span class="string">&quot;Re-get Backgroud Color[%d, %d, %d]&quot;</span>, red, green, blue);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 调用服务，刷新背景颜色</span></span><br><span class="line">	ros::service::<span class="built_in">waitForService</span>(<span class="string">&quot;/clear&quot;</span>);</span><br><span class="line">	ros::ServiceClient clear_background = node.<span class="built_in">serviceClient</span>&lt;std_srvs::Empty&gt;(<span class="string">&quot;/clear&quot;</span>);</span><br><span class="line">	std_srvs::Empty srv;</span><br><span class="line">	clear_background.<span class="built_in">call</span>(srv);</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">sleep</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>添加cmake编译选项，不再重复。</p>
<p>运行后，更改了。</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250922205135270.png" alt="image-20250922205135270"></p>
<h2 id="十三、launch文件的使用"><a href="#十三、launch文件的使用" class="headerlink" title="十三、launch文件的使用"></a>十三、launch文件的使用</h2><p>上文中，启动一个ros节点需要使用rosrun命令，每次启动都有打开一个新的终端，十分麻烦。</p>
<p>通过编写launch文件，将多个节点的内容写入进去，就可以一次性开启多个节点。</p>
<ul>
<li>launch文件可以放在任意一个软件包的目录下</li>
<li>启动launch文件时自动运行roscore，启动rosmaseter。</li>
<li>必须按照launch文件内容的格式进行编写，&#x2F;为结尾。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">		<span class="comment">//节点1</span></span><br><span class="line">        &lt;node pkg=<span class="string">&quot;learning_service&quot;</span> type=<span class="string">&quot;turtle_spawn&quot;</span> name=<span class="string">&quot;turtle_spawn&quot;</span> /&gt;</span><br><span class="line">    	<span class="comment">//节点2</span></span><br><span class="line">        &lt;node pkg=<span class="string">&quot;turtlesim&quot;</span> type=<span class="string">&quot;turtlesim_node&quot;</span> name=<span class="string">&quot;turtlesim_node&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></table></figure>

<p>在launch文件中，为一个节点添加 **launch-prefix&#x3D;”gnome-terminal-e”**属性，可以让节点单独运行在一个独立终端中。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;node pkg=<span class="string">&quot;learning_service&quot;</span> type=<span class="string">&quot;turtle_spawn&quot;</span> name=<span class="string">&quot;turtle_spawn&quot;</span> launch-prefix=<span class="string">&quot;gnome-terminal-e&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>



<h2 id="十四、Ros机器人运动控制"><a href="#十四、Ros机器人运动控制" class="headerlink" title="十四、Ros机器人运动控制"></a>十四、Ros机器人运动控制</h2><p>在上面的基本实验中，我们掌握了基本的话题消息订阅发布、客户端服务端服务发送。</p>
<p>现在，可以添加机器人仿真环境，利用ros来实验控制机器人运行了。</p>
<h3 id="安装机器人仿真环境"><a href="#安装机器人仿真环境" class="headerlink" title="安装机器人仿真环境"></a>安装机器人仿真环境</h3><p>打开src目录，下载仿真环境pkg</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/6-robot/wpr_simulation.git</span><br></pre></td></tr></table></figure>

<p>运行包内的安装程序</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd Ros_WorkSpace/wpr_simulation/scrips</span><br><span class="line">./install_for_noetic.sh</span><br></pre></td></tr></table></figure>

<p>安装完成后，回到workspace编译（source和编译再后文中默认进行）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roslaunch wpr_simulation wpb_simple.launch</span><br></pre></td></tr></table></figure>

<p>可以看到一个仿真界面</p>
<h3 id="创建pkg，编写程序实现基本的运动控制"><a href="#创建pkg，编写程序实现基本的运动控制" class="headerlink" title="创建pkg，编写程序实现基本的运动控制"></a>创建pkg，编写程序实现基本的运动控制</h3><p>创建vel_pkg并添加roscpp rospy geometry_msgs依赖</p>
<p>添加vel_node函数，内容如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//初始化</span></span><br><span class="line">    ros::<span class="built_in">init</span>(argc, argv, <span class="string">&quot;vel_node&quot;</span>);</span><br><span class="line">	<span class="comment">//创建句柄</span></span><br><span class="line">    ros::NodeHandle n ;</span><br><span class="line">	<span class="comment">//定义发布对象vel_pub</span></span><br><span class="line">    ros::Publisher vel_pub = 	</span><br><span class="line">    <span class="comment">//发布话题，类型是geo内的twist，话题名叫cmd_vel</span></span><br><span class="line">    n.advertise&lt;geometry_msgs::<span class="built_in">Twist</span>(<span class="string">&quot;/cmd_vel&quot;</span>, <span class="number">10</span>);</span><br><span class="line">	<span class="comment">//定义数据类型 </span></span><br><span class="line">    geometry_msgs::Twist vel_msg;</span><br><span class="line"></span><br><span class="line">    vel_msg.linear.x = <span class="number">0</span>;</span><br><span class="line">    vel_msg.linear.y = <span class="number">0</span>;</span><br><span class="line">    vel_msg.linear.z = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    vel_msg.angular.x = <span class="number">0</span>;</span><br><span class="line">    vel_msg.angular.y = <span class="number">0</span>;</span><br><span class="line">    vel_msg.angular.z = <span class="number">0.6</span>;</span><br><span class="line">	</span><br><span class="line">    <span class="function">ros::Rate <span class="title">r</span><span class="params">(<span class="number">30</span>)</span></span>;</span><br><span class="line">    <span class="comment">//开启while循环，不断发布消息</span></span><br><span class="line">    <span class="keyword">while</span> (ros::<span class="built_in">ok</span>()) &#123;</span><br><span class="line">        vel_pub.<span class="built_in">publish</span>(vel_msg);</span><br><span class="line">        r.<span class="built_in">sleep</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在cmakelist中找到这两个选项，复制并取消注释，里面名字更改成自己的c++文件名</p>
<p>经典操作了，以后不再赘述</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250923123719319.png" alt="image-20250923123719319"></p>
<p>编译运行后，就可以看到仿真里面的机器人按照你的程序进行运动了。</p>
<h2 id="十五、激光雷达"><a href="#十五、激光雷达" class="headerlink" title="十五、激光雷达"></a>十五、激光雷达</h2><h3 id="TOF激光雷达"><a href="#TOF激光雷达" class="headerlink" title="TOF激光雷达"></a>TOF激光雷达</h3><p>雷达分为激光发射和接受两个模块，通过激光的发射与接收能测定障碍物的距离，再不断旋转雷达，就能测定周围的环境。</p>
<p>只要激光发射接收频率足够快，旋转速度足够快，就能实时得到周围环境。</p>
<p>而在ros中Rviz，我们得到的是一个激光雷达的点阵图。</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250924114550648.png" alt="image-20250924114550648"></p>
<h3 id="Rviz"><a href="#Rviz" class="headerlink" title="Rviz"></a>Rviz</h3><p>全名叫做Robot Visualization Tool ，是一个可视化工具。可以可视化传感器的数据，机器人运算处理的中间结果，比如显示路径规划，目标框选。</p>
<h4 id="操作："><a href="#操作：" class="headerlink" title="操作："></a>操作：</h4><ul>
<li><p>启动仿真程序后，在终端中输入rviz。<img src="/home/chonqin/.config/Typora/typora-user-images/image-20250924115406006.png" alt="image-20250924115406006"></p>
</li>
<li><p>修改左边界面显示，左下角add RobotModel和LaserScan，如图（如果没有机器人模型的话就source一下再打开rviz）</p>
</li>
</ul>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250924120357814.png" alt="image-20250924120357814">****</p>
<ul>
<li><p>这一排红色点阵就是雷达获取的数据，可以在仿真环境中添加障碍物来查看rviz的显示</p>
<p>  <img src="/home/chonqin/.config/Typora/typora-user-images/image-20250924121504960.png" alt="image-20250924121504960"></p>
</li>
<li><p>可以导出此次的配置文件，然后下次打开rviz后再open配置文件。点击左上角的flies目录就可以看到</p>
</li>
</ul>
<h4 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h4><ul>
<li>rviz只是一个数据可视化界面，用于显示机器人获取的数据，无论他是仿真机器人还是真实的机器人</li>
<li>可以通过launch文件来自动配置rviz的参数</li>
<li></li>
</ul>
<h4 id="Ros中激光雷达的消息包格式"><a href="#Ros中激光雷达的消息包格式" class="headerlink" title="Ros中激光雷达的消息包格式"></a>Ros中激光雷达的消息包格式</h4><p>在roswiki官网中可以打开sensor_msgs&#x2F;LaserScan Message，注释翻译成中文</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250924121815175.png" alt="image-20250924121815175"></p>
<p>可以在终端中显示消息类型</p>
<p>输入rostopic echo &#x2F;scan –noarr</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250924121950186.png" alt="image-20250924121950186"></p>
<h3 id="用c-实现获取激光雷达"><a href="#用c-实现获取激光雷达" class="headerlink" title="用c++实现获取激光雷达"></a>用c++实现获取激光雷达</h3><p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250924195957070.png" alt="image-20250924195957070"></p>
<ul>
<li><p>构建一个新的软件包，包名为lidar_pkg</p>
</li>
<li><p>新建一个节点，lidar_node</p>
</li>
<li><p>在节点中，向ros大管家nodehandle申请订阅话题，并设置回调函数为lidarcallback（）</p>
</li>
<li><p>构建回调函数，接受并处理数据</p>
</li>
<li><p>调用ros_info()显示雷达检测到的前方障碍物距离</p>
<p>  函数如下：</p>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">lidar_Callback</span><span class="params">(<span class="type">const</span> sensor_msgs::LaserScan msg)</span> </span>&#123;</span><br><span class="line">    <span class="type">float</span> fMidDist = msg.ranges[<span class="number">180</span>];</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">&quot;前方测距 ranges[180] = %f 米&quot;</span>,fMidDist);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL, <span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    ros::<span class="built_in">init</span>(argc, argv, <span class="string">&quot;lidar_node&quot;</span>);</span><br><span class="line"></span><br><span class="line">    ros::NodeHandle n ;</span><br><span class="line"></span><br><span class="line">    ros::Subscriber lidar_sub = n.<span class="built_in">subscribe</span>(<span class="string">&quot;/scan&quot;</span>, <span class="number">10</span>, &amp;lidar_Callback);</span><br><span class="line"></span><br><span class="line">    ros::<span class="built_in">spin</span> ();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>编译运行后，再打开仿真工具，移动前方的书架，可以看到距离的变化</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250924205150384.png" alt="image-20250924205150384"></p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250924205207354.png" alt="image-20250924205207354"></p>
<h2 id="十六、实现简单的避障控制"><a href="#十六、实现简单的避障控制" class="headerlink" title="十六、实现简单的避障控制"></a>十六、实现简单的避障控制</h2><p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250924205557332.png" alt="image-20250924205557332"></p>
<p>在上一节的基础上修改程序就可以了</p>
<ul>
<li>发布速度控制话题&#x2F;cmd_vel</li>
<li>构建速度控制消息包，vel_cmd用于数据传输</li>
<li>根据激光雷达的测距值，调整机器人运动速度，避开障碍</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">ros::Publisher vel_pub ;</span><br><span class="line"><span class="type">int</span> n = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">lidar_Callback</span><span class="params">(<span class="type">const</span> sensor_msgs::LaserScan msg)</span> </span>&#123;</span><br><span class="line">    <span class="type">float</span> fMidDist = msg.ranges[<span class="number">180</span>];</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">&quot;前方测距 ranges[180] = %f 米&quot;</span>,fMidDist);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (n&gt;<span class="number">0</span>) &#123;</span><br><span class="line">        n--;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    geometry_msgs::Twist vel_cmd;</span><br><span class="line">    <span class="keyword">if</span> (fMidDist &lt; <span class="number">1.5</span>) &#123;</span><br><span class="line">        vel_cmd.angular.z = <span class="number">0.3</span>;</span><br><span class="line">        n=<span class="number">50</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        vel_cmd.linear.x = <span class="number">0.1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    vel_pub.<span class="built_in">publish</span>(vel_cmd);</span><br><span class="line">  	<span class="comment">//如果没有速度的输入，机器人会按照最近一次的速度运动</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL, <span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    ros::<span class="built_in">init</span>(argc, argv, <span class="string">&quot;lidar_node&quot;</span>);</span><br><span class="line"></span><br><span class="line">    ros::NodeHandle n ;</span><br><span class="line"></span><br><span class="line">    ros::Subscriber lidar_sub = n.<span class="built_in">subscribe</span>(<span class="string">&quot;/scan&quot;</span>, <span class="number">10</span>, &amp;lidar_Callback);</span><br><span class="line"></span><br><span class="line">                    vel_pub  = n.<span class="built_in">advertise</span>&lt;geometry_msgs::Twist&gt;(<span class="string">&quot;/cmd_vel&quot;</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    ros::<span class="built_in">spin</span> ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="十七、Ros中IMU的使用"><a href="#十七、Ros中IMU的使用" class="headerlink" title="十七、Ros中IMU的使用"></a>十七、Ros中IMU的使用</h2><h3 id="Imu-Message"><a href="#Imu-Message" class="headerlink" title="Imu Message"></a>Imu Message</h3><p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250925105143048.png" alt="image-20250925105143048"></p>
<ul>
<li>angular_veloity ——————x,y,z三轴的旋转速度</li>
<li>liner——acceleration——————xyz三轴矢量加速度</li>
<li>orientation——————xyz经处理后的偏移量，数据类型是Quaternion，包含float x，y ，z ，w。四元数描述。</li>
</ul>
<h3 id="C-实现imu数据获取"><a href="#C-实现imu数据获取" class="headerlink" title="C++实现imu数据获取"></a>C++实现imu数据获取</h3><p>Ros官方给出了三个话题</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250925110052247.png" alt="image-20250925110052247"></p>
<ul>
<li><p>六轴原始数据</p>
</li>
<li><p>六轴原始数据和融合后的四元数姿态描述</p>
</li>
<li><p>加上磁力计的九轴数据</p>
<p>  <strong>Cpp实现步骤</strong>：</p>
</li>
<li><p>创建一个新的pkg</p>
</li>
<li><p>建立节点，imu_node</p>
</li>
<li><p>编程构建imu_node,利用回调函数对imu的数据进行处理</p>
</li>
<li><p>使用tf工具转换数据，并屏幕打印</p>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">IMUCallback</span><span class="params">(<span class="type">const</span> sensor_msgs::Imu msg)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 检测消息包中四元数数据是否存在</span></span><br><span class="line">    <span class="keyword">if</span>(msg.orientation_covariance[<span class="number">0</span>] &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// 四元数转成欧拉角</span></span><br><span class="line">    <span class="function">tf::Quaternion <span class="title">quaternion</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">        msg.orientation.x,</span></span></span><br><span class="line"><span class="params"><span class="function">        msg.orientation.y,</span></span></span><br><span class="line"><span class="params"><span class="function">        msg.orientation.z,</span></span></span><br><span class="line"><span class="params"><span class="function">        msg.orientation.w</span></span></span><br><span class="line"><span class="params"><span class="function">    )</span></span>;</span><br><span class="line">    <span class="type">double</span> roll, pitch, yaw;</span><br><span class="line">    tf::<span class="built_in">Matrix3x3</span>(quaternion).<span class="built_in">getRPY</span>(roll, pitch, yaw);</span><br><span class="line">    <span class="comment">// 弧度换算成角度</span></span><br><span class="line">    roll = roll*<span class="number">180</span>/M_PI;</span><br><span class="line">    pitch = pitch*<span class="number">180</span>/M_PI;</span><br><span class="line">    yaw = yaw*<span class="number">180</span>/M_PI;</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">&quot;滚转= %.0f 俯仰= %.0f 朝向= %.0f&quot;</span>, roll, pitch, yaw);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv, <span class="string">&quot;demo_imu_data&quot;</span>);</span><br><span class="line"></span><br><span class="line">    ros::NodeHandle n;</span><br><span class="line">    <span class="comment">// 订阅 IMU 的数据话题</span></span><br><span class="line">    ros::Subscriber sub = n.<span class="built_in">subscribe</span>(<span class="string">&quot;imu/data&quot;</span>, <span class="number">100</span>, IMUCallback);</span><br><span class="line">    ros::<span class="built_in">spin</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="实现与运动控制的结合"><a href="#实现与运动控制的结合" class="headerlink" title="实现与运动控制的结合"></a>实现与运动控制的结合</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">ros::Publisher vel_pub ;</span><br><span class="line"><span class="comment">// IMU 回调函数</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">IMUCallback</span><span class="params">(<span class="type">const</span> sensor_msgs::Imu msg)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 检测消息包中四元数数据是否存在</span></span><br><span class="line">    <span class="keyword">if</span>(msg.orientation_covariance[<span class="number">0</span>] &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// 四元数转成欧拉角</span></span><br><span class="line">    <span class="function">tf::Quaternion <span class="title">quaternion</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">        msg.orientation.x,</span></span></span><br><span class="line"><span class="params"><span class="function">        msg.orientation.y,</span></span></span><br><span class="line"><span class="params"><span class="function">        msg.orientation.z,</span></span></span><br><span class="line"><span class="params"><span class="function">        msg.orientation.w</span></span></span><br><span class="line"><span class="params"><span class="function">    )</span></span>;</span><br><span class="line">    <span class="type">double</span> roll, pitch, yaw;</span><br><span class="line">    tf::<span class="built_in">Matrix3x3</span>(quaternion).<span class="built_in">getRPY</span>(roll, pitch, yaw);</span><br><span class="line">    <span class="comment">// 弧度换算成角度</span></span><br><span class="line">    roll = roll*<span class="number">180</span>/M_PI;</span><br><span class="line">    pitch = pitch*<span class="number">180</span>/M_PI;</span><br><span class="line">    yaw = yaw*<span class="number">180</span>/M_PI;</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">&quot;滚转= %.0f 俯仰= %.0f 朝向= %.0f&quot;</span>, roll, pitch, yaw);</span><br><span class="line">		<span class="comment">//此处可以设计pid算法</span></span><br><span class="line">    <span class="type">double</span> t_yaw = <span class="number">90</span>;</span><br><span class="line">    <span class="type">float</span> kp ,ki ,kd ;</span><br><span class="line">    <span class="type">double</span> error = t_yaw - yaw ;</span><br><span class="line"></span><br><span class="line">    geometry_msgs::Twist vel_cmd;</span><br><span class="line">    kp = <span class="number">0.02</span> ;</span><br><span class="line">    vel_cmd.angular.z = error *kp ;</span><br><span class="line">    vel_cmd.linear.x = <span class="number">0.1</span> ;</span><br><span class="line">    vel_pub.<span class="built_in">publish</span>(vel_cmd);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv, <span class="string">&quot;demo_imu_data&quot;</span>);</span><br><span class="line"></span><br><span class="line">    ros::NodeHandle n;</span><br><span class="line">    <span class="comment">// 订阅 IMU 的数据话题</span></span><br><span class="line">    ros::Subscriber sub = n.<span class="built_in">subscribe</span>(<span class="string">&quot;imu/data&quot;</span>, <span class="number">100</span>, IMUCallback);</span><br><span class="line">        vel_pub = n.<span class="built_in">advertise</span>&lt;geometry_msgs::Twist&gt;(<span class="string">&quot;cmd_vel&quot;</span>, <span class="number">100</span>);</span><br><span class="line">    ros::<span class="built_in">spin</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="十八、栅格地图"><a href="#十八、栅格地图" class="headerlink" title="十八、栅格地图"></a>十八、栅格地图</h2><p>假设地图上有两个障碍物，以俯视观察他。将地图用大小相同的方格代替，被占据的格子（哪怕只占据一点）涂上黑色，未被占据的栅格涂上白色。如图</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250925193257940.png" alt="image-20250925193257940"></p>
<p><strong>切换栅格的大小可以让障碍物的表示更加精准，理论上可以无限逼近实际的大小</strong>。</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250925193415756.png" alt="image-20250925193415756"></p>
<ul>
<li>一个小正方形的边长（栅格边长）即为<strong>地图分辨率</strong>。</li>
<li>将黑色格子标记为1，空白格子为0，这样整个地图就可以以数组的形式存储数据来表示。</li>
</ul>
<h3 id="Ros栅格地图消息的数据结构"><a href="#Ros栅格地图消息的数据结构" class="headerlink" title="Ros栅格地图消息的数据结构"></a>Ros栅格地图消息的数据结构</h3><p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250925193836624.png" alt="image-20250925193836624"></p>
<p>info的包含如下：</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250925194150699.png" alt="image-20250925194150699"></p>
<h3 id="C-编写节点"><a href="#C-编写节点" class="headerlink" title="C++编写节点"></a>C++编写节点</h3><p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250925194447759.png" alt="image-20250925194447759"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">&quot;map_pub_node&quot;</span>);</span><br><span class="line">    ros::NodeHandle n ;</span><br><span class="line">    ros::Publisher pub = n.<span class="built_in">advertise</span>&lt;nav_msgs::OccupancyGrid&gt;(<span class="string">&quot;/map&quot;</span>,<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function">ros::Rate <span class="title">r</span><span class="params">(<span class="number">1</span>)</span> </span>;</span><br><span class="line">    <span class="keyword">while</span> (ros::ok) &#123;</span><br><span class="line">      	<span class="comment">//定义数据类型</span></span><br><span class="line">        nav_msgs::OccupancyGrid msg ;</span><br><span class="line">      	<span class="comment">//设置地图参数</span></span><br><span class="line">        msg.header.frame_id = <span class="string">&quot;map&quot;</span>;</span><br><span class="line">        msg.header.stamp = ros::Time::<span class="built_in">now</span>();</span><br><span class="line"></span><br><span class="line">        msg.info.origin.position.x = <span class="number">0</span>;</span><br><span class="line">        msg.info.origin.position.y = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        msg.info.resolution = <span class="number">1.0</span>;</span><br><span class="line">        msg.info.width = <span class="number">4</span>;</span><br><span class="line">        msg.info.height = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">        msg.data.<span class="built_in">resize</span>(<span class="number">8</span>);<span class="comment">//将八个格子的值清0</span></span><br><span class="line">				<span class="comment">//给地图赋值</span></span><br><span class="line">        msg.data[<span class="number">0</span>] = <span class="number">100</span>;</span><br><span class="line">        msg.data[<span class="number">1</span>] = <span class="number">100</span>;</span><br><span class="line">        msg.data[<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">        msg.data[<span class="number">3</span>] = <span class="number">-1</span>;</span><br><span class="line">				</span><br><span class="line">        pub.<span class="built_in">publish</span>(msg);</span><br><span class="line">        r.<span class="built_in">sleep</span>();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>启动roscore，启动节点，启动rviz</p>
<p>添加起始点（Axes）和Map，topic选择写好的&#x2F;map话题。可以看到地图按照我们定义的样子展现出来。</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250925201732674.png" alt="image-20250925201732674"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msg.info.origin.position.x = 2.0;</span><br><span class="line">msg.info.origin.position.y = 1.0;</span><br></pre></td></tr></table></figure>

<p>如果更改了上面的数值，他们不再为0，就会出现这样子的情况：</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250925202124104.png" alt="image-20250925202124104"></p>
<h2 id="十九、SLAM"><a href="#十九、SLAM" class="headerlink" title="十九、SLAM"></a>十九、SLAM</h2><p>全程是simultaneous localization and mapping，同时定位与地图创建。</p>
<p><strong>定位</strong>：是指机器人确定自己的位置。</p>
<h3 id="Slam的原理"><a href="#Slam的原理" class="headerlink" title="Slam的原理"></a>Slam的原理</h3><p>如何创建地图呢？？</p>
<p>先选定一个原点作为参照系，建立坐标轴，通过记录当前观测点与对应参照物的坐标，改变不同观测点，将多次记录的坐标进行比对，将参照物重合构建出一张完整的地图。</p>
<p><strong>在Ros中如何实现建图的功能呢</strong></p>
<p>首先，Ros是地图是栅格地图，机器人放置在环境中，没有开启传感器感知周围时，所有格子的值均为-1，涂上灰色。</p>
<p>假设此时机器人开启了雷达扫描功能，激光发射出去穿过的格子都标记为0，涂上白色，代表没有障碍物。直到激光撞到障碍物，反射回来，这个格子标记为100，涂上黑色。这样子就能得到当前观测点的周围障碍物情况，改变观测点后，又进行一次扫描，标记出周围的情况。将两次的标记情况进行特征重合，构建出局部的地图。不断重复这个过程，就可以得到一副完整的地图了。</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250926185458750.png" alt="image-20250926185458750"></p>
<h3 id="Ros中通过c-实现Slam"><a href="#Ros中通过c-实现Slam" class="headerlink" title="Ros中通过c++实现Slam"></a>Ros中通过c++实现Slam</h3><p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250926185810196.png" alt="image-20250926185810196"></p>
<p>激光雷达发送数据到slam节点进行处理（建图算法），在发布map话题让rviz可视化界面订阅，就可以显示地图出来了。</p>
<p>Slam算法节点在ros中有提供，叫做Hector_Mapping节点。不用重复造轮子。</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250926200118226.png" alt="image-20250926200118226"></p>
<p>通过运行前三条指令可以开启slam的扫描功能，在rviz界面中add选项添加机器人model和map地图</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250926201134977.png" alt="image-20250926201134977"></p>
<p>第四行指令可以开启一个图像化界面来控制机器人运动</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250926201231220.png" alt="image-20250926201231220"></p>
<p>控制机器人移动，建模成功。</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250926201452881.png" alt="image-20250926201452881"></p>
<h3 id="launch文件使用"><a href="#launch文件使用" class="headerlink" title="launch文件使用"></a>launch文件使用</h3><p>操作这么多有点麻烦，现在编写一个launch文件来一次性开启这些程序。</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250926204242519.png" alt="image-20250926204242519"></p>
<p>第一条语法是包含另一个launch文件的写法，￥（)用于查找括号下软件包的目录，后面接着具体文件路径。</p>
<p>其余三条，之前已经说明过。</p>
<p>编译运行。成功。</p>
<p>在rviz中导出配置好的rviz，放入pkg文件夹里的rviz目录下，并命名slam.rviz。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rviz -d ~/Ros_WorkSpace/src/slam_pkg/rviz/slam.rviz</span><br></pre></td></tr></table></figure>

<p>可以在终端输入这段代码打开rviz后自动加载配置文件，也可以打开rviz后再手动选择加载。</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250926205145607.png" alt="image-20250926205145607"></p>
<p>可以在launch中添加参数args ，通过rviz来自动加载rviz的配置。</p>
<p><img src="/home/chonqin/.config/Typora/typora-user-images/image-20250926205323599.png" alt="image-20250926205323599"></p>
<p>这样子就算自动配置好launch文件了。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://chonqin.github.io">chonqin</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://chonqin.github.io/year/11/01/ROS/">https://chonqin.github.io/year/11/01/ROS/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://chonqin.github.io" target="_blank">Hexo</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">chonqin</div><div class="author-info-description">Hello World!</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">1</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/chonqin"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Welcome !</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%80%8B%E2%80%94title-ROS%E5%9F%BA%E7%A1%80date-2025-11-01-21-10description-ROS%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E2%80%8B%E2%80%94"><span class="toc-number">1.</span> <span class="toc-text">​—title:ROS基础date:2025-11-01 21:10description:ROS学习记录​—</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ROS"><span class="toc-number">2.</span> <span class="toc-text">ROS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%89%8D%E8%A8%80"><span class="toc-number">2.1.</span> <span class="toc-text">一、前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81ros%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">2.2.</span> <span class="toc-text">二、ros是什么</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%8A%82%E7%82%B9-Node-%E4%B8%8E-%E8%8A%82%E7%82%B9%E7%AE%A1%E7%90%86%E5%99%A8-Node-Master"><span class="toc-number">2.2.1.</span> <span class="toc-text">1.节点(Node) 与 节点管理器(Node Master)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%80%9A%E4%BF%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E4%B8%80%E2%80%94%E2%80%94Topic%E6%A8%A1%E5%BC%8F"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.通信模式之一——Topic模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E9%80%9A%E4%BF%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E4%BA%8C%E2%80%94%E2%80%94Service%E6%A8%A1%E5%BC%8F"><span class="toc-number">2.2.3.</span> <span class="toc-text">3通信模式之二——Service模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%B8%A4%E8%80%85%E5%AF%B9%E6%AF%94"><span class="toc-number">2.2.4.</span> <span class="toc-text">4.两者对比</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0-Parameter"><span class="toc-number">2.2.5.</span> <span class="toc-text">参数(Parameter)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">2.3.</span> <span class="toc-text">三、文件系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81ROS%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7"><span class="toc-number">2.4.</span> <span class="toc-text">四、ROS命令行工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%9B%9E%E9%A1%BE%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%B0%8F%E6%B5%B7%E9%BE%9F%E7%A8%8B%E5%BA%8F"><span class="toc-number">2.4.1.</span> <span class="toc-text">1.回顾第一个小海龟程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9A%84%E8%AE%A1%E7%AE%97%E5%9B%BE%EF%BC%9Arqt-graph"><span class="toc-number">2.4.2.</span> <span class="toc-text">2.查看系统中的计算图：rqt_graph</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-rosnode"><span class="toc-number">2.4.3.</span> <span class="toc-text">3.rosnode</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%BE%E7%A4%BA%E8%8A%82%E7%82%B9%E5%88%97%E8%A1%A8%EF%BC%9Arosnode-list"><span class="toc-number">2.4.3.1.</span> <span class="toc-text">显示节点列表：rosnode list</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E8%8A%82%E7%82%B9%E4%BF%A1%E6%81%AF%EF%BC%9Arosnode-info"><span class="toc-number">2.4.3.2.</span> <span class="toc-text">查看节点信息：rosnode info</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-rostopic"><span class="toc-number">2.4.4.</span> <span class="toc-text">4.rostopic</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%BE%E7%A4%BAtopic%E5%88%97%E8%A1%A8%EF%BC%9Arostopic-list"><span class="toc-number">2.4.4.1.</span> <span class="toc-text">显示topic列表：rostopic list</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E5%8F%91%E5%B8%83%E6%95%B0%E6%8D%AE%E7%BB%99topic"><span class="toc-number">2.4.4.2.</span> <span class="toc-text">手动发布数据给topic</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-rosmsg"><span class="toc-number">2.4.5.</span> <span class="toc-text">5.rosmsg</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%B6%88%E6%81%AF%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">2.4.5.1.</span> <span class="toc-text">查看消息数据结构</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E4%BD%BF%E7%94%A8%E6%9C%8D%E5%8A%A1%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F%EF%BC%9Arosservice"><span class="toc-number">2.4.6.</span> <span class="toc-text">6.使用服务通信方式：rosservice</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%9C%8D%E5%8A%A1%E5%88%97%E8%A1%A8%EF%BC%9Arosservice-list"><span class="toc-number">2.4.6.1.</span> <span class="toc-text">查看服务列表：rosservice list</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E9%80%9A%E8%BF%87%E6%9C%8D%E5%8A%A1%E6%9D%A5%E8%BF%9B%E8%A1%8C%E6%93%8D%E4%BD%9C"><span class="toc-number">2.4.6.2.</span> <span class="toc-text">手动通过服务来进行操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E8%AF%9D%E9%A2%98%E8%AE%B0%E5%BD%95%E5%92%8C%E5%A4%8D%E7%8E%B0%EF%BC%9Arosbag"><span class="toc-number">2.4.7.</span> <span class="toc-text">7.话题记录和复现：rosbag</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%88%9B%E5%BB%BAros%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4%E4%B8%8E%E5%8A%9F%E8%83%BD%E5%8C%85"><span class="toc-number">2.5.</span> <span class="toc-text">五、创建ros工作空间与功能包</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-What-is-Workspace-%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4"><span class="toc-number">2.5.1.</span> <span class="toc-text">1.What is Workspace(工作空间)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%9B%E5%BB%BA%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4"><span class="toc-number">2.5.2.</span> <span class="toc-text">2 .创建工作空间</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA"><span class="toc-number">2.5.2.1.</span> <span class="toc-text">创建:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E7%A9%BA%E4%BB%A3%E7%A0%81%E7%9A%84%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4"><span class="toc-number">2.5.2.2.</span> <span class="toc-text">编译空代码的工作空间</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%88%9B%E5%BB%BA%E5%8A%9F%E8%83%BD%E5%8C%85"><span class="toc-number">2.5.3.</span> <span class="toc-text">3.创建功能包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%AE%BE%E7%BD%AE%E5%B9%B6%E6%A3%80%E6%9F%A5%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">2.5.4.</span> <span class="toc-text">4.设置并检查环境变量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%8F%91%E5%B8%83%E8%80%85Publisher%E7%9A%84%E7%BC%96%E7%A8%8B%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.6.</span> <span class="toc-text">六、发布者Publisher的编程实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%8F%91%E5%B8%83%E8%80%85%E7%A8%8B%E5%BA%8F%EF%BC%9A"><span class="toc-number">2.6.1.</span> <span class="toc-text">如何实现一个发布者程序：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E6%93%8D%E4%BD%9C%E5%A6%82%E4%B8%8B%EF%BC%9A"><span class="toc-number">2.6.2.</span> <span class="toc-text">具体操作如下：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E7%A8%8B%E5%BA%8F%E5%A6%82%E4%B8%8B%EF%BC%9A"><span class="toc-number">2.6.3.</span> <span class="toc-text">具体程序如下：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E8%AE%A2%E9%98%85%E8%80%85Sub%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.7.</span> <span class="toc-text">七、订阅者Sub的实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A8%8B%E5%BA%8F%E5%A6%82%E4%B8%8B"><span class="toc-number">2.7.1.</span> <span class="toc-text">程序如下</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E8%AF%9D%E9%A2%98%E6%B6%88%E6%81%AF%E7%9A%84%E5%AE%9A%E4%B9%89%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="toc-number">2.8.</span> <span class="toc-text">八、话题消息的定义和使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81Servce%E6%A8%A1%E5%BC%8F%E7%9A%84%E7%BC%96%E7%A8%8B%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-number">2.9.</span> <span class="toc-text">九、Servce模式的编程与使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A8%8B%E5%BA%8F%E5%A6%82%E4%B8%8B-1"><span class="toc-number">2.9.1.</span> <span class="toc-text">程序如下</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E3%80%81%E6%9C%8D%E5%8A%A1%E7%AB%AFSever%E7%9A%84%E7%BC%96%E7%A8%8B%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.10.</span> <span class="toc-text">十、服务端Sever的编程实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81%E6%9C%8D%E5%8A%A1%E6%95%B0%E6%8D%AEsrv%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">2.11.</span> <span class="toc-text">十一、服务数据srv的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAsrv%E6%96%87%E4%BB%B6"><span class="toc-number">2.11.1.</span> <span class="toc-text">创建srv文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%8A%9F%E8%83%BD%E5%8C%85%E4%BE%9D%E8%B5%96"><span class="toc-number">2.11.2.</span> <span class="toc-text">添加功能包依赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E7%BC%96%E8%AF%91%E9%80%89%E9%A1%B9"><span class="toc-number">2.11.3.</span> <span class="toc-text">添加编译选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%90%8E%EF%BC%8C%E7%BC%96%E8%AF%91%E5%B9%B6%E8%BF%90%E8%A1%8C"><span class="toc-number">2.11.4.</span> <span class="toc-text">最后，编译并运行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81%E5%8F%82%E6%95%B0%E7%9A%84%E4%BD%BF%E7%94%A8%E4%B8%8E%E7%BC%96%E7%A8%8B"><span class="toc-number">2.12.</span> <span class="toc-text">十二、参数的使用与编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">2.12.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BApkg"><span class="toc-number">2.12.2.</span> <span class="toc-text">创建pkg</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rosparam%E4%BD%BF%E7%94%A8"><span class="toc-number">2.12.3.</span> <span class="toc-text">rosparam使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E7%A8%8B%E5%BA%8F%E6%9D%A5%E4%BD%BF%E7%94%A8%E5%8F%82%E6%95%B0"><span class="toc-number">2.12.4.</span> <span class="toc-text">利用程序来使用参数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%89%E3%80%81launch%E6%96%87%E4%BB%B6%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">2.13.</span> <span class="toc-text">十三、launch文件的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E5%9B%9B%E3%80%81Ros%E6%9C%BA%E5%99%A8%E4%BA%BA%E8%BF%90%E5%8A%A8%E6%8E%A7%E5%88%B6"><span class="toc-number">2.14.</span> <span class="toc-text">十四、Ros机器人运动控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%9C%BA%E5%99%A8%E4%BA%BA%E4%BB%BF%E7%9C%9F%E7%8E%AF%E5%A2%83"><span class="toc-number">2.14.1.</span> <span class="toc-text">安装机器人仿真环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BApkg%EF%BC%8C%E7%BC%96%E5%86%99%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E5%9F%BA%E6%9C%AC%E7%9A%84%E8%BF%90%E5%8A%A8%E6%8E%A7%E5%88%B6"><span class="toc-number">2.14.2.</span> <span class="toc-text">创建pkg，编写程序实现基本的运动控制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%BA%94%E3%80%81%E6%BF%80%E5%85%89%E9%9B%B7%E8%BE%BE"><span class="toc-number">2.15.</span> <span class="toc-text">十五、激光雷达</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TOF%E6%BF%80%E5%85%89%E9%9B%B7%E8%BE%BE"><span class="toc-number">2.15.1.</span> <span class="toc-text">TOF激光雷达</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rviz"><span class="toc-number">2.15.2.</span> <span class="toc-text">Rviz</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%EF%BC%9A"><span class="toc-number">2.15.2.1.</span> <span class="toc-text">操作：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Tips"><span class="toc-number">2.15.2.2.</span> <span class="toc-text">Tips</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Ros%E4%B8%AD%E6%BF%80%E5%85%89%E9%9B%B7%E8%BE%BE%E7%9A%84%E6%B6%88%E6%81%AF%E5%8C%85%E6%A0%BC%E5%BC%8F"><span class="toc-number">2.15.2.3.</span> <span class="toc-text">Ros中激光雷达的消息包格式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8c-%E5%AE%9E%E7%8E%B0%E8%8E%B7%E5%8F%96%E6%BF%80%E5%85%89%E9%9B%B7%E8%BE%BE"><span class="toc-number">2.15.3.</span> <span class="toc-text">用c++实现获取激光雷达</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E5%85%AD%E3%80%81%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84%E9%81%BF%E9%9A%9C%E6%8E%A7%E5%88%B6"><span class="toc-number">2.16.</span> <span class="toc-text">十六、实现简单的避障控制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%83%E3%80%81Ros%E4%B8%ADIMU%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">2.17.</span> <span class="toc-text">十七、Ros中IMU的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Imu-Message"><span class="toc-number">2.17.1.</span> <span class="toc-text">Imu Message</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#C-%E5%AE%9E%E7%8E%B0imu%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96"><span class="toc-number">2.17.2.</span> <span class="toc-text">C++实现imu数据获取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E4%B8%8E%E8%BF%90%E5%8A%A8%E6%8E%A7%E5%88%B6%E7%9A%84%E7%BB%93%E5%90%88"><span class="toc-number">2.17.3.</span> <span class="toc-text">实现与运动控制的结合</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E5%85%AB%E3%80%81%E6%A0%85%E6%A0%BC%E5%9C%B0%E5%9B%BE"><span class="toc-number">2.18.</span> <span class="toc-text">十八、栅格地图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Ros%E6%A0%85%E6%A0%BC%E5%9C%B0%E5%9B%BE%E6%B6%88%E6%81%AF%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">2.18.1.</span> <span class="toc-text">Ros栅格地图消息的数据结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#C-%E7%BC%96%E5%86%99%E8%8A%82%E7%82%B9"><span class="toc-number">2.18.2.</span> <span class="toc-text">C++编写节点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B9%9D%E3%80%81SLAM"><span class="toc-number">2.19.</span> <span class="toc-text">十九、SLAM</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Slam%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-number">2.19.1.</span> <span class="toc-text">Slam的原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ros%E4%B8%AD%E9%80%9A%E8%BF%87c-%E5%AE%9E%E7%8E%B0Slam"><span class="toc-number">2.19.2.</span> <span class="toc-text">Ros中通过c++实现Slam</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#launch%E6%96%87%E4%BB%B6%E4%BD%BF%E7%94%A8"><span class="toc-number">2.19.3.</span> <span class="toc-text">launch文件使用</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/year/11/01/ROS/" title="无标题">无标题</a><time datetime="2025-11-01T14:05:50.498Z" title="更新于 2025-11-01 22:05:50">2025-11-01</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By chonqin</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.1</a></span></div><div class="footer_custom_text">By chonqin</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.1"></script><script src="/js/main.js?v=5.5.1"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>